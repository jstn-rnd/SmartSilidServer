<!DOCTYPE html>
<html>
<head>
    <title>Screen Stream</title>
    <script>
        function refreshStream() {
            const streamImg = document.getElementById('stream');
            if (streamImg) {
                streamImg.src = streamImg.src.split('?')[0] + '?' + new Date().getTime(); // Force refresh
            }
        }

        // Polling function to check if the stream should be refreshed
        function pollStreamStatus() {
            fetch("{% url 'stream_status' %}")
                .then(response => response.json())
                .then(data => {
                    if (data.active) {
                        refreshStream();
                    }
                });
        }

        // Poll every 5 seconds
        setInterval(pollStreamStatus, 5000);
    </script>
</head>
<body>
    <h1>Server Screen Stream</h1>
    
    <img id="stream" src="{% url 'stream' %}" alt="Live Stream" />
    
    <p><a href="{% url 'control' %}">Go to Control Panel</a></p>
</body>
</html>
